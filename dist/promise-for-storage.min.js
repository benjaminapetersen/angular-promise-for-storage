"use strict";angular.module("promise-for-storage",[]).config([function(){}]),angular.module("promise-for-storage").factory("localStore",["$log","$q",function(e,t){var r=window.localStorage,n={all:function(e,n){return t.when(n?r.setItem(e,JSON.stringify(n)):JSON.parse(r.getItem(e)||"[]"))},create:function(e,t){return n.all(e).then(function(n){return n.push(t),r.setItem(e,JSON.stringify(n))})},get:function(e,t){return t=Number(t),n.all(e).then(function(e){return e&&e.length?_.find(e,function(e){return e.id===t}):void 0})},update:function(e,t){return n.remove(e,t.id).then(function(n){n.push(t),r.setItem(e,JSON.stringify(n))})},remove:function(e,t){return t=Number(t),n.all(e).then(function(n){var o=_.reject(n,function(e){return e.id===t});return r.setItem(e,JSON.stringify(o)),o})},clear:function(e){return t.when(r.removeItem(e))}};return n}]),angular.module("promise-for-storage").factory("sessionStore",["$log","$q",function(e,t){var r=window.sessionStorage,n={all:function(e,n){return t.when(n?r.setItem(e,JSON.stringify(n)):JSON.parse(r.getItem(e)||"[]"))},create:function(e,t){return n.all(e).then(function(n){return n.push(t),r.setItem(e,JSON.stringify(n))})},get:function(e,t){return t=Number(t),n.all(e).then(function(e){return e&&e.length?_.find(e,function(e){return e.id===t}):void 0})},update:function(e,t){return n.remove(e,t.id).then(function(n){n.push(t),r.setItem(e,JSON.stringify(n))})},remove:function(e,t){return t=Number(t),n.all(e).then(function(n){var o=_.reject(n,function(e){return e.id===t});return r.setItem(e,JSON.stringify(o)),o})},clear:function(e){return t.when(r.removeItem(e))}};return n}]),angular.module("promise-for-storage").factory("crud",["localStore","sessionStore",function(e,t){var r={local:e,session:t},n=function(){return this.store=void 0,this.key=void 0,this};return n.prototype.setStore=function(e){return this.store=e,this},n.prototype.setKey=function(e){var t=this;if(this.key=e,!this.store)throw new Error("select store with Crud().store(store_name)");return{all:function(e){return e?r[t.store].all(t.key,e):r[t.store].all(t.key)},create:function(e){return r[t.store].create(t.key,e)},update:function(e){return r[t.store].update(t.key,e)},get:function(e){return r[t.store].get(t.key,e)},remove:function(e){return r[t.store].remove(t.key,e)},clear:function(e){return r[t.store].clear(e)}}},new n}]);